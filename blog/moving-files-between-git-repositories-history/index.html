<!doctype html><html lang=en-au><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta property="og:site_name" content="Michail Konst"><meta property="og:type" content="article"><meta property="og:image" content="https://www.michailkonst.com//img/home.jpg"><meta property="twitter:image" content="https://www.michailkonst.com//img/home.jpg"><meta name=title content="Preserve commit history when moving files across Git repositories"><meta property="og:title" content="Preserve commit history when moving files across Git repositories"><meta property="twitter:title" content="Preserve commit history when moving files across Git repositories"><meta name=description content><meta property="og:description" content><meta property="twitter:description" content><meta property="og:url" content="https://www.michailkonst.com/blog/moving-files-between-git-repositories-history/"><meta property="twitter:card" content="Learn how to preserve your commit history when moving files between Git repositories, ensuring that valuable project history and context are retained during the transfer process."><meta name=keyword content><link rel="shortcut icon" href=/img/favicon.ico><title>Preserve commit history when moving files across Git repositories | Michail Konst</title>
<link rel=canonical href=/blog/moving-files-between-git-repositories-history/><link rel=stylesheet href=/css/bootstrap.min.css><link rel=stylesheet href=/css/hugo-theme-cleanwhite.min.css><link rel=stylesheet href=/css/zanshang.min.css><link rel=stylesheet href=/css/font-awesome.all.min.css><link rel=stylesheet href=https://www.michailkonst.com/css/custom.css><script src=/js/jquery.min.js></script><script src=/js/bootstrap.min.js></script><script src=/js/hux-blog.min.js></script><script src=/js/lazysizes.min.js></script></head><nav class="navbar navbar-default navbar-custom navbar-fixed-top"><div class=container-fluid><div class="navbar-header page-scroll"><button type=button class=navbar-toggle>
<span class=sr-only>Toggle navigation</span>
<span class=icon-bar></span>
<span class=icon-bar></span>
<span class=icon-bar></span>
</button>
<a class=navbar-brand href=/>Michail Konst</a></div><div id=huxblog_navbar><div class=navbar-collapse><ul class="nav navbar-nav navbar-right"><li><a href=/>All Posts</a></li><li><a href=/about//>ABOUT</a></li><li><a href=/search><i class="fa fa-search"></i></a></li></ul></div></div></div></nav><script>var $body=document.body,$toggle=document.querySelector(".navbar-toggle"),$navbar=document.querySelector("#huxblog_navbar"),$collapse=document.querySelector(".navbar-collapse");$toggle.addEventListener("click",handleMagic);function handleMagic(){$navbar.className.indexOf("in")>0?($navbar.className=" ",setTimeout(function(){$navbar.className.indexOf("in")<0&&($collapse.style.height="0px")},400)):($collapse.style.height="auto",$navbar.className+=" in")}</script><style type=text/css>header.intro-header{background-image:url(/img/home.jpg)}</style><header class=intro-header><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><div class=post-heading><div class=tags></div><h1>Preserve commit history when moving files across Git repositories</h1><h2 class=subheading></h2><span class=meta>Posted by
Michail Konst
on
Thursday, November 2, 2023</span></div></div></div></div></header><article><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2
col-md-10 col-md-offset-1
post-container"><p>When managing projects in Git, there may come a time when you need to transfer specific files or directories, along with their entire history, from one repository to another. This can be a useful process when reorganizing your codebase, separating concerns, or simply consolidating repositories. In this blog post, we&rsquo;ll explore a step-by-step guide to achieve this task seamlessly.</p><h2 id=step-1-clone-or-copy-the-source-repository>Step 1: Clone or Copy the Source Repository</h2><p>Start by accessing your source repository — the one containing the files and history you want to move. You can either clone it from your remote origin or copy your local repository if you already have it on your system. You want a copy separate from your working local repository, as we&rsquo;ll be doing some history rewriting.</p><h2 id=step-2-remove-the-origin-remote>Step 2: Remove the Origin Remote</h2><p>To prevent any accidental pushes to your origin, remove the remote origin by running the following command:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>git remote rm origin
</span></span></code></pre></div><p>This step ensures that you won&rsquo;t inadvertently propagate any history rewriting to the original repository.</p><h2 id=step-3-keep-the-history-of-only-the-files-and-folders-you-want-to-move-across>Step 3: Keep the history of only the files and folders you want to move across</h2><p>Now, you&rsquo;re ready to filter and preserve the history of the specific file or directory you want to move. Use the following command:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>git filter-branch --subdirectory-filter path/to/dir-or-file -- --all
</span></span></code></pre></div><p>If there is no commit history of those files in the branch you are currently in, the command may abort with a &ldquo;Found nothing to rewrite&rdquo; message. In such cases, you can use the following command, which is also handy when you have multiple paths to preserve:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>git filter-branch --index-filter <span style=color:#e6db74>&#39;git rm --cached -qr --ignore-unmatch -- . &amp;&amp; git reset -q $GIT_COMMIT -- path/to/dir1 path/to/dir-or-file-2&#39;</span> --prune-empty -- --all
</span></span></code></pre></div><p>This command filters the repository&rsquo;s history to keep only the files and directories you specified.</p><h2 id=step-4-clean-up>Step 4: Clean Up</h2><p>After filtering, clean up any remaining artifacts from the history rewrite:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>git reset --hard
</span></span><span style=display:flex><span>git gc --aggressive
</span></span><span style=display:flex><span>git prune
</span></span><span style=display:flex><span>git clean -fd
</span></span></code></pre></div><p>These commands ensure that your repository is in a clean state following the history modification.</p><h2 id=step-5-add-a-local-remote-to-the-source-repository>Step 5: Add a Local Remote to the Source Repository</h2><p>Now, switch to your target repository—the one where you want to move the files and history. Add a local remote pointing to the source repository you cloned or copied earlier. Replace with a meaningful name and ../ with the relative path to the source repository:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>git remote add &lt;source&gt; ../&lt;sourcedir&gt;
</span></span></code></pre></div><h2 id=step-6-pull-files-and-history-from-the-source>Step 6: Pull Files and History from the Source</h2><p>Use the following command to pull the files and history from the source repository into your target repository, using the remote name you specified:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>git pull &lt;source&gt; &lt;branch you want to pull from&gt; --allow-unrelated-histories
</span></span></code></pre></div><p>This command merges the source repository&rsquo;s history into your target repository, preserving both histories.</p><h2 id=step-7-remove-the-local-remote>Step 7: Remove the Local Remote</h2><p>After the merge is successful, you can remove the local remote pointing to the source repository:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>git remote rm &lt;source&gt;
</span></span></code></pre></div><h2 id=step-8-commit-and-push>Step 8: Commit and Push</h2><p>Finally, commit the changes to your target repository with a descriptive message:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>git commit -m <span style=color:#e6db74>&#34;Moved folders from other repository&#34;</span>
</span></span></code></pre></div><p>Push the changes to update your remote repository:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>git push
</span></span></code></pre></div><p>Now, you can delete those files and folders from your source repository.</p><p>You&rsquo;ve successfully moved files and their entire history from one Git repository to another. This process allows you to maintain a clean and organized codebase while preserving valuable historical data.</p><hr><ul class=pager><li class=previous><a href=/blog/publisling-jekyll-site-to-a-separate-github-pages/ data-toggle=tooltip data-placement=top title="Publishing a Jekyll site to a separate Github Pages repository using Github Actions">&larr;
Previous Post</a></li><li class=next><a href=/blog/automate-all-the-things-a-manifesto-for-building-better-teams/ data-toggle=tooltip data-placement=top title="Automate All The Things: A Manifesto for Building Better Teams">Next
Post &rarr;</a></li></ul></div><div class="col-lg-2 col-lg-offset-0
visible-lg-block
sidebar-container
catalog-container"><div class=side-catalog><hr class="hidden-sm hidden-xs"><h5><a class=catalog-toggle href=#>Contents</a></h5><ul class=catalog-body></ul></div></div><div class="col-lg-8 col-lg-offset-2
col-md-10 col-md-offset-1
sidebar-container"></div></div></div></article><footer><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><ul class="list-inline text-center"><li><a href=https://x.com/michailkonst><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-twitter fa-stack-1x fa-inverse"></i></span></a></li><li><a target=_blank href=https://github.com/michailkonst><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-github fa-stack-1x fa-inverse"></i></span></a></li><li><a target=_blank href=https://www.linkedin.com/in/michailkonstant/><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-linkedin fa-stack-1x fa-inverse"></i></span></a></li></ul><p class="copyright text-muted">Copyright &copy; Michail Konst 2025</p></div></div></div></footer><script>function loadAsync(e,t){var s=document,o="script",n=s.createElement(o),i=s.getElementsByTagName(o)[0];n.src=e,t&&n.addEventListener("load",function(e){t(null,e)},!1),i.parentNode.insertBefore(n,i)}</script><script>$("#tag_cloud").length!==0&&loadAsync("/js/jquery.tagcloud.js",function(){$.fn.tagcloud.defaults={color:{start:"#bbbbee",end:"#0085a1"}},$("#tag_cloud a").tagcloud()})</script><script>loadAsync("https://cdn.jsdelivr.net/npm/fastclick@1.0.6/lib/fastclick.min.js",function(){var e=document.querySelector("nav");e&&FastClick.attach(e)})</script><script type=text/javascript>function generateCatalog(e){_containerSelector="div.post-container";var t,n,s,o,i,a=$(_containerSelector),r=a.find("h1,h2,h3,h4,h5,h6");return $(e).html(""),r.each(function(){n=$(this).prop("tagName").toLowerCase(),o="#"+$(this).prop("id"),t=$(this).text(),i=$('<a href="'+o+'" rel="nofollow" title="'+t+'">'+t+"</a>"),s=$('<li class="'+n+'_nav"></li>').append(i),$(e).append(s)}),!0}generateCatalog(".catalog-body"),$(".catalog-toggle").click(function(e){e.preventDefault(),$(".side-catalog").toggleClass("fold")}),loadAsync("/js/jquery.nav.js",function(){$(".catalog-body").onePageNav({currentClass:"active",changeHash:!1,easing:"swing",filter:"",scrollSpeed:700,scrollOffset:0,scrollThreshold:.2,begin:null,end:null,scrollChange:null,padding:80})})</script></body></html>